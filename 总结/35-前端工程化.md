## 工具

参考资料：[commitizen + husky 规范git提交信息](https://juejin.im/post/5dff29646fb9a0160b638631)

> 输入提示信息

[commitizen](https://github.com/commitizen/cz-cli)

[cz-conventional-changelog](https://github.com/commitizen/cz-conventional-changelog)

[cz-conventional-emoji](https://github.com/gaoac/cz-conventional-emoji)

> lint工具

[@commitlint/config-conventional](https://github.com/conventional-changelog/commitlint/tree/master/@commitlint/config-conventional)

[@commitlint/cli](https://github.com/conventional-changelog/commitlint)

> 自定义lint

[commitlint-config-cz](https://github.com/whizark/commitlint-config-cz)

[cz-customizable](https://github.com/leonardoanalista/cz-customizable)

> 捕获commit

[husky](https://github.com/typicode/husky)

> 生成changelog

[standard-version](https://github.com/conventional-changelog/standard-version)





1. 安装 输入提示信息 相关

   `yarn add commitizen cz-conventional-changelog cz-conventional-emoji -D`

2. 设置 `scripts`

   ```json
   "scripts":{
       commit:"git-cz"
   },
   "config": {
       "commitizen": {
         "path": "node_modules/cz-conventional-changelog"
       }
   },
   ```

3. 安装 提交校验工具

   - 上面工具只提示信息，但是没有做提交约束(校验)

   - 要在创建之前对提交进行 lint 提交，可以使用 Husky 的 commit-msg 钩子：

     - `yarn add husky -D` 

     - `yarn husky install`
     - `yarn husky add .husky/commit-msg 'npx --no -- commitlint --edit "$1"'`
   
   - 安装校验工具
   
     `yarn add @commitlint/config-conventional @commitlint/cli -D`
   
   - 创建`commitlint.config.js`
   
     ```js
     module.exports = {
         extents:[
             "@commitlint/config-conventional"
         ],
         rules:{
             'body-leading-blank': [1, 'always'],
             'footer-leading-blank': [1, 'always'],
             'header-max-length': [2, 'always', 72],
             'scope-case': [2, 'always', 'lower-case'],
             'subject-case': [
                 2,
                 'never',
                 ['sentence-case', 'start-case', 'pascal-case', 'upper-case']
             ],
             'subject-empty': [2, 'never'],
             'subject-full-stop': [2, 'never', '.'],
             'type-case': [2, 'always', 'lower-case'],
             'type-empty': [2, 'never'],
             'type-enum': [
                 2,
                 'always',
                 [
                     'build',
                     'chore',
                     'ci',
                     'docs',
                     'feat',
                     'fix',
                     'improvement',
                     'perf',
                     'refactor',
                     'revert',
                     'style',
                     'test'
                 ]
             ]
         }
     }
     ```
   
4. 自定义提交规范

   `yarn add commitlint-config-cz  cz-customizable -D`

   ```js
   // commitlint.config.js
   module.exports = {    
       extends: [        
           '@commitlint/config-conventional',
           'cz'    
       ],
        rules:{
         // Header 
        'header-max-length': [2, 'always', 200],
         // <type>枚举
         'type-enum': [2, 'always', [
           'init',
           'feat',
           'fix',
           'ui',
           'refactor',
           'replace',
           'deploy',
           'docs',
           'test',
           'chore',
           'style',
           'revert',
           'add',
           'minus',
           'del'
         ]],
         // <type> 不能为空
         'type-empty': [2, 'never'],
         // <type> 格式 小写 
        'type-case': [2, 'always', 'lower-case'],
         // <scope> 不能为空
         'scope-empty': [2, 'never'],
         // <scope> 格式 小写
         'scope-case': [2, 'always', 'lower-case'],
         // <subject> 不能为空
         'subject-empty': [2, 'never'],
         // <subject> 以.为结束标志
         'subject-full-stop': [2, 'never', '.'],
         // <subject> 格式
         // 可选值
         // 'lower-case' 小写 lowercase
         // 'upper-case' 大写 UPPERCASE
         // 'camel-case' 小驼峰 camelCase
         // 'kebab-case' 短横线 kebab-case
         // 'pascal-case' 大驼峰 PascalCase
         // 'sentence-case' 首字母大写 Sentence case
         // 'snake-case' 下划线 snake_case
         // 'start-case' 所有首字母大写 start-case
         'subject-case': [2, 'never', []],
         // <body> 以空行开头
         'body-leading-blank': [1, 'always'],
         // <footer> 以空行开头
         'footer-leading-blank': [1, 'always']
       }}
   ```

   ```json
   // package.json
   "config": {
       "commitizen": {
         "path": "node_modules/cz-customizable"
       }
     },
   ```

   ```js
   // .cz-config.js
   module.exports = {
     types: [
       { value: "✨feat",          name: "feat:          增加新功能" },
       { value: "🐛fix",           name: "fix:           修复bug" },
       { value: "📝docs",          name: "docs:          修改文档" },
       { value: "⚡️perf",           name: "perf:          性能优化" },
       { value: "🎉init",          name: "init:          初始提交" },
       { value: "➕add",           name: "add:           添加依赖" },
       { value: "🔨build",         name: "build:         打包" },
       { value: "🔧chore",         name: "chore:         更改配置文件" },
       { value: "👷ci",            name: "ci:            CI部署" },
       { value: "🔥del",           name: "del:           删除代码/文件" },
       { value: "♻️refactor",      name: "refactor:      代码重构" },
       { value: "⏪revert",        name: "revert:        版本回退" },
       { value: "🍱style",         name: "style:         样式修改不影响逻辑" },
       { value: "✅test",          name: "test:          增删测试" },
     ],
     scopes: [],
     messages: {
       type: "选择一种你的提交类型:\n",
       scope: "更改的范围(可选):\n",
       // 如果allowcustomscopes为true，则使用
       // customScope: 'Denote the SCOPE of this change:',
       subject: "简短描述:\n",
       body: '详细描述. 使用"|"换行(可选):\n',
       breaking: "Breaking Changes列表:\n",
       footer: "关闭的issues列表. E.g.: #31, #34(可选):\n",
       confirmCommit: "确认提交?",
     },
     allowCustomScopes: true,
     allowBreakingChanges: ["feat", "fix"],
   };
   ```

   ```js
   // commitlint.config.js
   module.exports = {
           extends: [
                   'cz'
           ]
   }
   ```

   

