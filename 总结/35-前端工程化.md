## å·¥å…·

å‚è€ƒèµ„æ–™ï¼š[commitizen + husky è§„èŒƒgitæäº¤ä¿¡æ¯](https://juejin.im/post/5dff29646fb9a0160b638631)

> è¾“å…¥æç¤ºä¿¡æ¯

[commitizen](https://github.com/commitizen/cz-cli)

[cz-conventional-changelog](https://github.com/commitizen/cz-conventional-changelog)

[cz-conventional-emoji](https://github.com/gaoac/cz-conventional-emoji)

> lintå·¥å…·

[@commitlint/config-conventional](https://github.com/conventional-changelog/commitlint/tree/master/@commitlint/config-conventional)

[@commitlint/cli](https://github.com/conventional-changelog/commitlint)

> è‡ªå®šä¹‰lint

[commitlint-config-cz](https://github.com/whizark/commitlint-config-cz)

[cz-customizable](https://github.com/leonardoanalista/cz-customizable)

> æ•è·commit

[husky](https://github.com/typicode/husky)

> ç”Ÿæˆchangelog

[standard-version](https://github.com/conventional-changelog/standard-version)





1. å®‰è£… è¾“å…¥æç¤ºä¿¡æ¯ ç›¸å…³

   `yarn add commitizen cz-conventional-changelog cz-conventional-emoji -D`

2. è®¾ç½® `scripts`

   ```json
   "scripts":{
       commit:"git-cz"
   },
   "config": {
       "commitizen": {
         "path": "node_modules/cz-conventional-changelog"
       }
   },
   ```

3. å®‰è£… æäº¤æ ¡éªŒå·¥å…·

   - ä¸Šé¢å·¥å…·åªæç¤ºä¿¡æ¯ï¼Œä½†æ˜¯æ²¡æœ‰åšæäº¤çº¦æŸ(æ ¡éªŒ)

   - è¦åœ¨åˆ›å»ºä¹‹å‰å¯¹æäº¤è¿›è¡Œ lint æäº¤ï¼Œå¯ä»¥ä½¿ç”¨ Husky çš„ commit-msg é’©å­ï¼š

     - `yarn add husky -D` 

     - `yarn husky install`
     - `yarn husky add .husky/commit-msg 'npx --no -- commitlint --edit "$1"'`
   
   - å®‰è£…æ ¡éªŒå·¥å…·
   
     `yarn add @commitlint/config-conventional @commitlint/cli -D`
   
   - åˆ›å»º`commitlint.config.js`
   
     ```js
     module.exports = {
         extents:[
             "@commitlint/config-conventional"
         ],
         rules:{
             'body-leading-blank': [1, 'always'],
             'footer-leading-blank': [1, 'always'],
             'header-max-length': [2, 'always', 72],
             'scope-case': [2, 'always', 'lower-case'],
             'subject-case': [
                 2,
                 'never',
                 ['sentence-case', 'start-case', 'pascal-case', 'upper-case']
             ],
             'subject-empty': [2, 'never'],
             'subject-full-stop': [2, 'never', '.'],
             'type-case': [2, 'always', 'lower-case'],
             'type-empty': [2, 'never'],
             'type-enum': [
                 2,
                 'always',
                 [
                     'build',
                     'chore',
                     'ci',
                     'docs',
                     'feat',
                     'fix',
                     'improvement',
                     'perf',
                     'refactor',
                     'revert',
                     'style',
                     'test'
                 ]
             ]
         }
     }
     ```
   
4. è‡ªå®šä¹‰æäº¤è§„èŒƒ

   `yarn add commitlint-config-cz  cz-customizable -D`

   ```js
   // commitlint.config.js
   module.exports = {    
       extends: [        
           '@commitlint/config-conventional',
           'cz'    
       ],
        rules:{
         // Header 
        'header-max-length': [2, 'always', 200],
         // <type>æšä¸¾
         'type-enum': [2, 'always', [
           'init',
           'feat',
           'fix',
           'ui',
           'refactor',
           'replace',
           'deploy',
           'docs',
           'test',
           'chore',
           'style',
           'revert',
           'add',
           'minus',
           'del'
         ]],
         // <type> ä¸èƒ½ä¸ºç©º
         'type-empty': [2, 'never'],
         // <type> æ ¼å¼ å°å†™ 
        'type-case': [2, 'always', 'lower-case'],
         // <scope> ä¸èƒ½ä¸ºç©º
         'scope-empty': [2, 'never'],
         // <scope> æ ¼å¼ å°å†™
         'scope-case': [2, 'always', 'lower-case'],
         // <subject> ä¸èƒ½ä¸ºç©º
         'subject-empty': [2, 'never'],
         // <subject> ä»¥.ä¸ºç»“æŸæ ‡å¿—
         'subject-full-stop': [2, 'never', '.'],
         // <subject> æ ¼å¼
         // å¯é€‰å€¼
         // 'lower-case' å°å†™ lowercase
         // 'upper-case' å¤§å†™ UPPERCASE
         // 'camel-case' å°é©¼å³° camelCase
         // 'kebab-case' çŸ­æ¨ªçº¿ kebab-case
         // 'pascal-case' å¤§é©¼å³° PascalCase
         // 'sentence-case' é¦–å­—æ¯å¤§å†™ Sentence case
         // 'snake-case' ä¸‹åˆ’çº¿ snake_case
         // 'start-case' æ‰€æœ‰é¦–å­—æ¯å¤§å†™ start-case
         'subject-case': [2, 'never', []],
         // <body> ä»¥ç©ºè¡Œå¼€å¤´
         'body-leading-blank': [1, 'always'],
         // <footer> ä»¥ç©ºè¡Œå¼€å¤´
         'footer-leading-blank': [1, 'always']
       }}
   ```

   ```json
   // package.json
   "config": {
       "commitizen": {
         "path": "node_modules/cz-customizable"
       }
     },
   ```

   ```js
   // .cz-config.js
   module.exports = {
     types: [
       { value: "âœ¨feat",          name: "feat:          å¢åŠ æ–°åŠŸèƒ½" },
       { value: "ğŸ›fix",           name: "fix:           ä¿®å¤bug" },
       { value: "ğŸ“docs",          name: "docs:          ä¿®æ”¹æ–‡æ¡£" },
       { value: "âš¡ï¸perf",           name: "perf:          æ€§èƒ½ä¼˜åŒ–" },
       { value: "ğŸ‰init",          name: "init:          åˆå§‹æäº¤" },
       { value: "â•add",           name: "add:           æ·»åŠ ä¾èµ–" },
       { value: "ğŸ”¨build",         name: "build:         æ‰“åŒ…" },
       { value: "ğŸ”§chore",         name: "chore:         æ›´æ”¹é…ç½®æ–‡ä»¶" },
       { value: "ğŸ‘·ci",            name: "ci:            CIéƒ¨ç½²" },
       { value: "ğŸ”¥del",           name: "del:           åˆ é™¤ä»£ç /æ–‡ä»¶" },
       { value: "â™»ï¸refactor",      name: "refactor:      ä»£ç é‡æ„" },
       { value: "âªrevert",        name: "revert:        ç‰ˆæœ¬å›é€€" },
       { value: "ğŸ±style",         name: "style:         æ ·å¼ä¿®æ”¹ä¸å½±å“é€»è¾‘" },
       { value: "âœ…test",          name: "test:          å¢åˆ æµ‹è¯•" },
     ],
     scopes: [],
     messages: {
       type: "é€‰æ‹©ä¸€ç§ä½ çš„æäº¤ç±»å‹:\n",
       scope: "æ›´æ”¹çš„èŒƒå›´(å¯é€‰):\n",
       // å¦‚æœallowcustomscopesä¸ºtrueï¼Œåˆ™ä½¿ç”¨
       // customScope: 'Denote the SCOPE of this change:',
       subject: "ç®€çŸ­æè¿°:\n",
       body: 'è¯¦ç»†æè¿°. ä½¿ç”¨"|"æ¢è¡Œ(å¯é€‰):\n',
       breaking: "Breaking Changesåˆ—è¡¨:\n",
       footer: "å…³é—­çš„issuesåˆ—è¡¨. E.g.: #31, #34(å¯é€‰):\n",
       confirmCommit: "ç¡®è®¤æäº¤?",
     },
     allowCustomScopes: true,
     allowBreakingChanges: ["feat", "fix"],
   };
   ```

   ```js
   // commitlint.config.js
   module.exports = {
           extends: [
                   'cz'
           ]
   }
   ```

   

